(function(t){function e(e){for(var r,s,i=e[0],u=e[1],l=e[2],c=0,h=[];c<i.length;c++)s=i[c],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&h.push(o[s][0]),o[s]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(t[r]=u[r]);d&&d(e);while(h.length)h.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,s=1;s<n.length;s++){var u=n[s];0!==o[u]&&(r=!1)}r&&(a.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},o={app:0},a=[];function s(t){return i.p+"js/"+({}[t]||t)+"."+{"chunk-18e3ca54":"6a212e63","chunk-2d0f0fc4":"0fe2f08d"}[t]+".js"}function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(t){var e=[],n=o[t];if(0!==n)if(n)e.push(n[2]);else{var r=new Promise((function(e,r){n=o[t]=[e,r]}));e.push(n[2]=r);var a,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=s(t);var l=new Error;a=function(e){u.onerror=u.onload=null,clearTimeout(c);var n=o[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src;l.message="Loading chunk "+t+" failed.\n("+r+": "+a+")",l.name="ChunkLoadError",l.type=r,l.request=a,n[1](l)}o[t]=void 0}};var c=setTimeout((function(){a({type:"timeout",target:u})}),12e4);u.onerror=u.onload=a,document.head.appendChild(u)}return Promise.all(e)},i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var c=0;c<u.length;c++)e(u[c]);var d=l;a.push([1,"chunk-vendors"]),n()})({0:function(t,e){},"08d2":function(t,e,n){t.exports=n.p+"img/butterfly.362a3d92.svg"},1:function(t,e,n){t.exports=n("cd49")},10:function(t,e){},2:function(t,e){},"2f45":function(t,e,n){"use strict";var r=n("9b8e"),o=n.n(r);o.a},3:function(t,e){},4:function(t,e){},5:function(t,e){},6:function(t,e){},7:function(t,e){},8:function(t,e){},9:function(t,e){},"9b8e":function(t,e,n){},b9f9:function(t,e,n){"use strict";var r=n("f80f"),o=n.n(r);o.a},cd49:function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"paper",(function(){return H})),n.d(r,"waitForPaper",(function(){return B})),n.d(r,"setPaper",(function(){return z})),n.d(r,"show",(function(){return E})),n.d(r,"showPathCut",(function(){return V})),n.d(r,"showCut",(function(){return $})),n.d(r,"approxShape",(function(){return A})),n.d(r,"bufferPoints",(function(){return M})),n.d(r,"bufferPath",(function(){return T})),n.d(r,"isArgTrue",(function(){return D})),n.d(r,"isArgFalse",(function(){return I})),n.d(r,"fixPoint",(function(){return _})),n.d(r,"getRelativePoint",(function(){return R})),n.d(r,"generatePointsInPath",(function(){return G})),n.d(r,"fixSVG",(function(){return W})),n.d(r,"roundCorners",(function(){return L}));n("cadf"),n("551c"),n("f751"),n("097d");var o=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-app-bar",{attrs:{app:""}},[n("v-toolbar-title",{staticClass:"headline text-uppercase"},[n("span",[t._v("Plottrbottr")]),n("span",{staticClass:"font-weight-light subtitle"},[t._v("Lace Maker 2")])]),n("v-spacer"),n("v-btn",{attrs:{text:"",href:"https://github.com/vuetifyjs/vuetify/releases/latest",target:"_blank"}})],1),n("v-content",[n("HelloWorld")],1)],1)},s=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",[n("div",{staticClass:"dat",attrs:{id:"dat"}},[t.laceMaker?n("dat-gui",{attrs:{closeText:"Close controls",openText:"Open controls",closePosition:"bottom"}},[n("dat-boolean",{attrs:{label:"Voronoi"},model:{value:t.args.voronoi,callback:function(e){t.$set(t.args,"voronoi",e)},expression:"args.voronoi"}}),n("dat-boolean",{attrs:{label:"Rounded shapes"},model:{value:t.args.rounded,callback:function(e){t.$set(t.args,"rounded",e)},expression:"args.rounded"}}),n("dat-number",{attrs:{label:"Outline Size (in)"},model:{value:t.args.outlineSize,callback:function(e){t.$set(t.args,"outlineSize",e)},expression:"args.outlineSize"}}),n("dat-number",{attrs:{label:"Safe Border (in)"},model:{value:t.args.safeBorder,callback:function(e){t.$set(t.args,"safeBorder",e)},expression:"args.safeBorder"}}),n("dat-boolean",{attrs:{label:"Subtract Mode"},model:{value:t.args.subtract,callback:function(e){t.$set(t.args,"subtract",e)},expression:"args.subtract"}}),t.args.subtract?n("dat-number",{attrs:{label:"Subtract Buffer"},model:{value:t.args.subtractBuffer,callback:function(e){t.$set(t.args,"subtractBuffer",e)},expression:"args.subtractBuffer"}}):t._e(),n("dat-number",{attrs:{label:"Outline Approx Points"},model:{value:t.args.numPoints,callback:function(e){t.$set(t.args,"numPoints",e)},expression:"args.numPoints"}}),n("dat-number",{attrs:{label:"Extra Points"},model:{value:t.args.numExtraPoints,callback:function(e){t.$set(t.args,"numExtraPoints",e)},expression:"args.numExtraPoints"}}),n("dat-folder",{attrs:{label:"Sizing"}},[n("dat-number",{attrs:{label:"Max Width (in)"},model:{value:t.args.maxWidth,callback:function(e){t.$set(t.args,"maxWidth",e)},expression:"args.maxWidth"}}),n("dat-number",{attrs:{label:"Max Height (in)"},model:{value:t.args.maxHeight,callback:function(e){t.$set(t.args,"maxHeight",e)},expression:"args.maxHeight"}})],1),n("dat-number",{attrs:{label:"Seed"},model:{value:t.args.randomSeed,callback:function(e){t.$set(t.args,"randomSeed",e)},expression:"args.randomSeed"}})],1):t._e()],1),n("v-row",[n("v-col",{attrs:{cols:"1"}}),n("v-col",{attrs:{sm:"11",md:"7"}},[n("v-row",{staticClass:"pb-4"},[n("file-upload",{ref:"upload",attrs:{extensions:"svg",accept:"image/svg+xml",multiple:!1},on:{input:t.fileUploaded},model:{value:t.files,callback:function(e){t.files=e},expression:"files"}},[t.$refs.upload&&t.$refs.upload.active?t._e():n("v-btn",{on:{click:function(e){e.preventDefault(),t.$refs.upload.active=!0}}},[t._v("Upload SVG")])],1)],1),n("v-row",[n("canvas",{attrs:{id:"myCanvas",resize:""}}),n("div",{staticStyle:{width:"245px"}},[t._v("Â ")])]),n("v-row",{staticClass:"pt-6"},[t.laceMaker?n("v-btn",{on:{click:function(e){return e.preventDefault(),t.downloadSVG(e)}}},[t._v("Download Lace-y SVG")]):t._e()],1)],1)],1)],1)},u=[],l=(n("7f7f"),n("28a5"),n("96cf"),n("3b8d")),c=n("d225"),d=n("b0b4"),h=n("308d"),f=n("6bb5"),p=n("4e2b"),g=n("9ab4"),b=n("60a3"),m=n("8019"),v=n.n(m),x=n("55377"),w=n.n(x),y=(n("2222"),n("2d955")),P=n("f6f6"),S=n("eb7f"),k=n("8060"),j=n("909d");const O=!1,C=!1;let H=null;async function B(){return H||(H=k.isBrowser?await n.e("chunk-18e3ca54").then(n.t.bind(null,"63dd",1)):await Promise.all([n.e("chunk-18e3ca54"),n.e("chunk-2d0f0fc4")]).then(n.t.bind(null,"9f67",1)),H=H.default,H)}function z(t){H=t}function E(t,e){if(O){let n=[t];P.isArray(t)&&(n=t),n.forEach(t=>{H.project.activeLayer.addChild(t),t.style={strokeWidth:1,strokeColor:e||"green"}})}}function V(t,e){H.project.activeLayer.addChild(t),t.style={strokeWidth:C?"0.001pt":"1px",strokeColor:e||"red",fill:"none"}}function $(t,e){P.isArray(t)?t.forEach(t=>V(t,e)):V(t)}function A(t,e=200){let n=[],r=t;t instanceof H.CompoundPath&&(r=t.children[0]);for(let o=0;o<e;o++)n.push(r.getPointAt(o/e*r.length));return n.map(t=>r.localToGlobal(t))}function M(t,e){const n=1e3,r=1/n*10,o=e.map(t=>{return{X:t.x*n+r,Y:t.y*n+r}}),a=new S.default([o]),s=a.offset(t*n,{jointType:"jtRound",endType:"etClosedPolygon",roundPrecision:50});if(!s||!s.paths||0==s.paths.length)return null;if(!s||!s.paths||0==s.paths.length)return null;const i=s.paths.map(t=>new H.Path(t.map(t=>{return new H.Point(t.X/n,t.Y/n)})));return i}function T({buffer:t,path:e,numPoints:n}){const r=A(e,n);return M(t,r)}function D(t){return null!=t&&void 0!=t&&"no"!=t&&"false"!=t}function I(t){return!D(t)}function _({point:t,shape:e}){return new H.Point(t.x+e.bounds.x,t.y+e.bounds.y/2)}function R({shape:t,pos:e}){return _({shape:t,point:t.getPointAt(e)})}function G({path:t,exclude:e,numExtraPoints:n}){console.log("making extra points",n);const r=[];while(r.length<2*n){const n=new H.Point(Math.random()*t.bounds.width+t.bounds.x,Math.random()*t.bounds.height+t.bounds.y);!t.contains(n)||e&&e.contains(n)||(r.push([n.x,n.y]),E(new H.Path.Circle(n,.02),"lightblue"))}return console.log("done with extra points"),r}function W(t){let e=null;const n=j.JSDOM,r=new n(t);e=r.window.document;const o=e.querySelectorAll('path[d=""]');console.log(`have ${o.length} empty Ds to remove`),o.forEach(t=>t.remove());const a=e.querySelector("svg");return a.outerHTML}function L(t,e){var n=t.segments.slice(0);t.removeSegments();for(var r=0,o=n.length;r<o;r++){var a=n[r].point,s=n[r+1==o?0:r+1].point,i=n[r-1<0?n.length-1:r-1].point,u=a.subtract(s),l=a.subtract(i);u.length=e,l.length=e,t.add(new H.Segment(a.subtract(l),null,l.divide(2))),t.add(new H.Segment(a.subtract(u),u.divide(2),null))}return t.closed=!0,t}const U=y.Delaunay,{showCut:J,show:q,approxShape:F,bufferPath:N,bufferPoints:X,generatePointsInPath:Y,roundCorners:K}=r;let Q=null;async function Z(){console.error("waiitng for paper in lace maker"),Q=await B()}class tt{constructor({debug:t,holeSize:e,inchInPoints:n,rounded:r,subtract:o,subtractBuffer:a,numPoints:s,numExtraPoints:i,voronoi:u,addHole:l,butt:c,maxWidth:d,maxHeight:h,safeBorder:f,outlineSize:p}){this.debug=t,this.rounded=r,this.subtract=o,this.inchInPoints=n,this.numPoints=s,this.numExtraPoints=i,this.voronoi=u,this.addHole=l,this.butt=c,this.maxWidth=d,this.maxHeight=h,this.safeBorder=f,this.subtractBuffer=a,this.outlineSize=p,this.threadHoleSize=this.pointInches(e),this.threadHoleBuffer=this.pointInches(.04),this.threadHoleTotalSize=this.threadHoleSize+this.threadHoleBuffer,this.debug||(console.log=t=>{})}pointInches(t){return t*this.inchInPoints}inchPoints(t){return t/this.inchInPoints}loadAndResizeSvg({svgData:t,yOffset:e=0,xOffset:n=0}){var r=Q.project.importSVG(t);const o=r.children[1];console.log("num children",r.children.length);let a=o;o.children&&(a=P.sortBy(o.children,t=>-t.length)[0],console.log("num children children",o.children.length));const s=this.pointInches(this.maxWidth),i=this.pointInches(this.maxHeight);console.log(`current size: ${this.inchPoints(a.bounds.width)} x ${this.inchPoints(a.bounds.height)}`);const u=Math.min(s/a.bounds.width,i/a.bounds.height);return r=r.scale(u),r.translate(new Q.Point(-a.bounds.x+n,-a.bounds.y+e)),console.log(`new size: ${this.inchPoints(a.bounds.width)} x ${this.inchPoints(a.bounds.height)}`),console.log(`new size: ${this.inchPoints(r.bounds.width)} x ${this.inchPoints(r.bounds.height)}`),r.remove(),a}doAddHole({path:t,size:e,buffer:n}){if(!this.addHole)return void J(t);let r=new Q.Point(0,1),o=new Q.Point(t.bounds.width/2,0);this.butt&&t.bounds.width/t.bounds.height>3&&(r=new Q.Point(-1,0),o=new Q.Point(t.bounds.x+t.bounds.width+2*(e+n),t.bounds.y+t.bounds.height/2));let a=new Q.Path.Circle(o,e+n);function s(t,e){console.log("length of path1",t.length),console.log("length of path1",t.area);const n=t.intersect(e,{insert:!1,trace:!1});return console.log("length of path1 after subtract path2",n.length),console.log("length of path1 after subtract path2",n.area),!!n&&(console.log(n.length),n.length<.5*t.length)}while(!a.intersects(t)||!s(a,t))a=a.translate(r);a.scale(1.2);for(let l=0;l<10;l++)a.translate(r);let i=t;i instanceof Q.CompoundPath&&(i=i.children[0]),J(a.unite(i));const u=new Q.Path.Circle(a.bounds.center,e);J(u)}buildTriangles({path:t}){const e=t;q(new Q.Path(F(t)),"brown");let n=N({buffer:-this.pointInches(this.safeBorder),path:t});q(n,"brown"),n.forEach(t=>this.processInnerShape({innerShape:t,outerShape:e}))}processInnerShape({outerShape:t,innerShape:e}){let n=N({buffer:-this.pointInches(this.subtractBuffer),path:t});q(n,"brown");const r=this.numPoints,o=this.pointsToArray(F(e,r));o.forEach(t=>q(new Q.Path.Circle(t,1),"blue"));const a=Y({path:e,numExtraPoints:this.numExtraPoints}),s=o.concat(a);console.log("triangulating");const i=U.from(s);console.log("done");let u=Array.from(i.trianglePolygons());if(this.voronoi){const e=i.voronoi([t.bounds.x,t.bounds.y,t.bounds.x+t.bounds.width,t.bounds.y+t.bounds.height]);u=Array.from(e.cellPolygons())}console.log(`have ${u.length} triangles`),u.forEach((t,r)=>{const o=t.map(t=>new Q.Point(t[0],t[1]));let a=X(-this.pointInches(this.outlineSize),o);if(a){a=a[0],a.closePath(),this.rounded&&(a=K(a,2)),a.closePath();let t=a.intersect(e);this.subtract&&n&&n.forEach(e=>t=t.subtract(e)),J(t)}else console.log(`could not shrink :-( triagnel ${r}`)})}pointsToArray(t){const e=[];return t.forEach(t=>{e.push([t.x,t.y])}),e}async loadAndProcessSvgData({svgData:t,paperModule:e}){e&&(Q=e,z(Q)),Q||(await Z(),Q.setup([10,10])),Q.settings.insertItems=!1;let n=this.loadAndResizeSvg({svgData:t,xOffset:2*this.threadHoleTotalSize,yOffset:2*this.threadHoleTotalSize});n.closed||(console.log("not closed outer ring"),process.exit(1)),this.buildTriangles({path:n}),this.doAddHole({path:n,size:this.threadHoleSize,buffer:this.threadHoleBuffer})}exportSVGString(){return Q.project.exportSVG({asString:!0,bounds:"content"})}}var et=n("08d2");b["b"].component("file-upload",v.a),b["b"].use(w.a);var nt=function(t){function e(){var t;return Object(c["a"])(this,e),t=Object(h["a"])(this,Object(f["a"])(e).apply(this,arguments)),t.files=[],t.laceMaker=null,t.filePrefix="",t.lastSVGData="",t.args={numExtraPoints:10,numPoints:50,maxWidth:3,maxHeight:3,voronoi:!0,subtract:!1,rounded:!1,subtractBuffer:.2,outlineSize:.03,safeBorder:.1,randomSeed:(new Date).getTime()},t}return Object(p["a"])(e,t),Object(d["a"])(e,[{key:"watcher",value:function(){this.rerender()}},{key:"mounted",value:function(){var t=document.getElementById("myCanvas");paper.setup(t),Math.seedrandom(this.args.randomSeed),this.loadButterfly(),this.loadHash(),this.updateHash()}},{key:"loadButterfly",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:fetch(et).then(function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(n){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.blob();case 2:return r=t.sent,e.filePrefix="butterfly",t.next=6,r.text();case 6:o=t.sent,e.processSVGData(o);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()},{key:"fileUploaded",value:function(t){var e=new FileReader,n=this;e.onload=function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=atob(e.target.result.substring(26)),t.next=3,n.processSVGData(r);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.filePrefix=t[0].file.name.split(".")[0],e.readAsDataURL(t[0].file)}},{key:"updateHash",value:function(){window.location.hash=JSON.stringify(this.args)}},{key:"loadHash",value:function(){window.location.hash.length>1&&(this.args=JSON.parse(decodeURI(window.location.hash.substring(1))))}},{key:"rerender",value:function(){this.updateHash(),this.processSVGData(this.lastSVGData)}},{key:"processSVGData",value:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.lastSVGData=e,this.laceMaker=new tt({debug:!1,inchInPoints:72,maxWidth:this.args.maxWidth,maxHeight:this.args.maxHeight,voronoi:this.args.voronoi,subtract:this.args.subtract,numPoints:this.args.numPoints,numExtraPoints:this.args.numExtraPoints,subtractBuffer:this.args.subtractBuffer,outlineSize:this.args.outlineSize,safeBorder:this.args.safeBorder,rounded:this.args.rounded,holeSize:0,addHole:!1,butt:!1}),paper.project.clear(),this.laceMaker.loadAndProcessSvgData({svgData:e,paperModule:paper}),paper.project.activeLayer.style.fillColor=null,paper.project.activeLayer.style.strokeWidth=.5,paper.project.activeLayer.fitBounds(paper.view.bounds);case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"downloadSVG",value:function(){var t=this.laceMaker.exportSVGString(),e=W(t),n=encodeURIComponent(e),r="data:image/svg+xml,",o=r+n,a=document.createElement("a");a.href=o;var s=this.filePrefix+this.args.randomSeed+".svg";return a.download=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),!1}}]),e}(b["b"]);Object(g["a"])([Object(b["c"])("args",{deep:!0})],nt.prototype,"watcher",null),nt=Object(g["a"])([b["a"]],nt);var rt=nt,ot=rt,at=(n("2f45"),n("2877")),st=n("6544"),it=n.n(st),ut=n("8336"),lt=n("62ad"),ct=n("a523"),dt=n("0fd9"),ht=Object(at["a"])(ot,i,u,!1,null,"1d9ed242",null),ft=ht.exports;it()(ht,{VBtn:ut["a"],VCol:lt["a"],VContainer:ct["a"],VRow:dt["a"]});var pt=o["a"].extend({name:"App",components:{HelloWorld:ft},data:function(){return{}}}),gt=pt,bt=(n("b9f9"),n("7496")),mt=n("40dc"),vt=n("a75b"),xt=n("2fa4"),wt=n("2a7f"),yt=Object(at["a"])(gt,a,s,!1,null,"45abd3df",null),Pt=yt.exports;it()(yt,{VApp:bt["a"],VAppBar:mt["a"],VBtn:ut["a"],VContent:vt["a"],VSpacer:xt["a"],VToolbarTitle:wt["a"]});var St=n("f309");o["a"].use(St["a"]);var kt=new St["a"]({icons:{iconfont:"mdi"}});o["a"].config.productionTip=!1,new o["a"]({vuetify:kt,render:function(t){return t(Pt)}}).$mount("#app")},f80f:function(t,e,n){}});
//# sourceMappingURL=app.c0e29f68.js.map